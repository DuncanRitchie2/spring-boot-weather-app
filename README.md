# Duncan&rsquo;s weather app with Spring Boot

ğŸŒªï¸ Using Spring Boot and the Mapbox and Dark Sky APIs to return weather data.

<h2>Structure</h2>

â˜€ï¸ https://spring-weather.herokuapp.com/ is the user interface, made with static HTML/CSS/JS.

ğŸŒ©ï¸ https://spring-weather.herokuapp.com/json?location=chester is my endpoint that returns 
Json data based on query. The Rest controller file for this is Json.java.

â˜” This Rest controller uses my method Request.locationToDarkSkyJsonString( location ) to return 
the stringified Json; the parameter is the natural-language string from the user input. This 
function calls Request.locationToMapboxJsonString( location ) to get Json from Mapbox including
the geographic address, latitude, and longitude.

ğŸŒ¬ï¸ The latitude and longitude is passed into Request.latLongToJsonString( latitude, longitude ), 
because the Dark Sky API requires a latitude and longitude input. This returns Json data 
describing the current and forecast weather conditions for the location.

ğŸŒ§ï¸ Once Request.latLongToJsonString() has returned the Dark Sky data, 
Request.locationToDarkSkyJsonString() then adds &mdash; somewhat hackily &mdash; the geographic
address into the Json string, so that the frontend can display the address above the weather data.

ğŸŒ€ Both Request.locationToMapboxJsonString() and Request.latLongToJsonString() call 
Request.requestUrlToString( url ), which accepts a URL as its parameter and uses the
java.net.HttpURLConnection class to make a request to the URL. It returns the Json as a string.
It is probably a lot more code than I really needed, but it works!

ğŸŒ¤ï¸ The URLs are generated by Url.getMapboxUrl( location ) and Url.getDarkSkyUrl( latitude, longitude).
These functions use the parameter(s) and my private API keys.

â˜ï¸ The API keys are returned by ApiKey.getMapboxKey() and ApiKey.getDarkSkyKey(). These two
methods use a try/catch block to return the keys either from the environment variables (in 
production on Heroku) or from Secrets.getMapboxKey() and Secrets.getDarkSkyKey().

ğŸŒ«ï¸ The two Secrets methods are in the Git history as just returning empty strings, but in
development they return the keys I have. (Any file called Secrets is covered by the .gitignore file.) 
I felt that I should give myself some way of keeping private data private, and this was what I 
came up with.

<h2>Extras</h2>

â„ï¸ https://spring-weather.herokuapp.com/chester returns HTML generated as a string by Java! It 
only relates to Chester because there&rsquo;s no interactivity, and it&rsquo;s controlled by
ChesterPage.java. I made the /chester page before I realised that using static files in 
Spring Boot was just a case of dropping them into a /static folder.

â˜ƒï¸ The background image of the /chester page is determined by a switch/case block in 
PhotoFromSummary.getUrl( summary ). The parameter is a summary of the current weather given 
by Dark Sky. The method matches the parameter to one of several URLs of public-domain photos
hosted by Flickr.

ğŸŒ• I also have an unused endpoint at /json2 (e.g. https://spring-weather.herokuapp.com/json2?lat=53.1921&lon=-2.8803 ).
This was useful in demonstrating that I can get Json data from an API (Dark Sky) and serve it in
the browser via a Java server, without mutating the data.

ğŸƒ Some of my functions are polymorphed, such that if the parameters are missing from the endpoints
(i.e. https://spring-weather.herokuapp.com/json?location= and https://spring-weather.herokuapp.com/json2?lat=0&lon=0 ),
default values are used. So if you want weather data for Null Island (i.e. the point in the Atlantic 
Ocean with zero latitude and zero longitude), you will probably get info for Chester instead.

<h2>Links</h2>

ğŸ§­ This weather project uses geographical data from Mapbox ( https://mapbox.com/about/maps ),
and weather data from Dark Sky ( https://darksky.net/poweredby/ ).

ğŸ’» I made this at Code Nation Chester ( https://wearecodenation.com/ ), where I am receiving training
on behalf of Information Catalyst ( http://informationcatalyst.com/ ), my employers who want to
know I understand how to consume Restful APIs and Json data with Java.

ğŸŒ See also my website ( https://www.duncanritchie.co.uk/ ).
